# Операционные системы UNIX/Linux (Базовый).
Установка и обновления системы Linux. Основы администрирования.


## Contents
1. [Установка ОС](#part-1-установка-ос)
2. [Создание пользователя](#part-2-создание-пользователя)
3. [Настройка сети ОС](#part-3-настройка-сети-ос)
4. [Обновление ОС](#part-4-обновление-ос)
5. [Использование команды  sudo](#part-5-использование-команды-sudo)
6. [Установка и настройка службы времени](#part-6-установка-и-настройка-службы-времени)
7. [Установка и использование текстовыхредакторов](#part-7-установка-и-использование-текстовых-редакторов)
8. [Установка и базовая настройка сервиса SSHD](#part-8-установка-и-базовая-настройка-сервиса-sshd)
9. [Установка и использование утилит top, htop](#part-9-установка-и-использование-утилит-top-htop)
10. [Использование утилиты fdisk](#part-10-использование-утилиты-fdisk)
11. [Использование утилиты df](#part-11-использование-утилиты-df)
12. [Использование утилиты du](#part-12-использование-утилиты-du)
13. [Установка и использование утилиты ncdu](#part-13-установка-и-использование-утилиты-ncdu)
14. [Работа с системными журналами](#part-14-работа-с-системными-журналами)
15. [Использование планировщика заданий CRON](#part-15-использование-планировщика-заданий-cron)

## Part 1. Установка ОС

- Вывод команды `cat /etc/issue`:\
![issue](src/imgs/Part_1_1.png)

## Part 2. Создание пользователя

- Создание нового пользователя 'user' с правами доступа к прочтению данных из папки /var/log:\
![adduser](src/imgs/Part_2_1.png)
- Вывод команды `cat /etc/passwd`:\
![newuser](src/imgs/Part_2_2.png)

## Part 3. Настройка сети ОС

- Смена имени машины:\
![hostname](src/imgs/Part_3_1.png)
- Синхронизируем время с текущим местоположением:\
![localtime](src/imgs/Part_3_2.png)
- Вывод списка сетевых интерфейсов командой `ifconfig`:\
![ifconfig](src/imgs/Part_3_3.png)\
Интерфейс lo — виртуальный интерфейс обратной петли и позволяет компьютеру обращатся к самому себе. Интерфейс имеет ip-адрес 127.0.0.1 и необходим для нормальной работы системы
- Вывод списка сетевых интерфейсов командой `ifconfig`:\
![ifconfig](src/imgs/Part_3_3.png)
- Получаем адрес сети при помощи подключенного DHCP:\
![ip](src/imgs/Part_3_4.png)\
DHCP («Dynamic Host Configuration Protocol») - сетевой протокол, позволяющий компьютерам автоматически получать IP-адрес и другие параметры.
- Файл списка базы данных адресов:\
![leases](src/imgs/Part_3_5.png)\
Изходя из базы данных видно, что ip-адресс устройства: `192.168.0.182`.
- Проверка ip, gw адресов шлюза:\
![adress](src/imgs/Part_3_6.png)\
Исходя из проверки становится ясно: ip-адресс - `192.168.0.0`, gw-адрес - `192.168.0.1`.
- Проверяем файл `/etc/cloud/cloud.cfg.d/subiquity-disable-cloudinit-networking.cfg` чтобы была отключена облачная инициализация.
- Открываем файл конфигурации Netplan (функции, регулирующей сетевое взаимодействие):\
![config](src/imgs/Part_3_7.png)
- Прописываем новые настройки для сети, заменяя автоматическое выделение адресов на статические:\
![reconfig](src/imgs/Part_3_8.png)
- Принимаем новые настройки при помощи команды `sudo netplan apply`.
- Проверяем при помощи команды `ifconfig` изменился ли ip-адресс:\
![ifconfig](src/imgs/Part_3_9.png)\
Как видим, наши действия изменили адрес c `192.168.0.182` на `192.168.0.100`.
- Пингуем поочерёдно сервера ya.ru и 1.1.1.1:\
![ping](src/imgs/Part_3_10.png)
![ping](src/imgs/Part_3_11.png)

## Part 4. Обновление ОС

- Для обновления системы используем команду  `sudo apt update && sudo apt full-upgrade`:\
![upd](src/imgs/Part_4_1.png)

## Part 5. Использование команды **sudo**

- Для разрешения использования Sudo прописываем новую группу для пользователя `sudo usermod -a -G sudo user`.\
Sudo используется для запуска команд от имени суперпользователя, либо обычного при помощи опции `-u`, так же позволяет переключаться между пользователями.
- Изменение hostname от имени пользователя 'user':\
![hostname](src/imgs/Part_5_1.png)

## Part 6. Установка и настройка службы времени

- Время было синхронизировано. Часовой пояс был настроен ранее. Отчет:\
![time](src/imgs/Part_6_1.png)

## Part 7. Установка и использование текстовых редакторов 

- Создал 3 файла командой `touch test_NANO.txt test_VIM.txt test_MCEDIT.txt`.
- При помощи соответствующих команд внес текст в файлы:
    - Редактор Nano:\
    ![print](src/imgs/Part_7_1.png)\
    Для выхода используется комбинация: `Ctrl + X`, `Y`, `Enter`.
    - Редактор Vim:\
    ![print](src/imgs/Part_7_2.png)\
    Для выхода используется комбинация: `Esc`, `:wq`, `Enter`.
    - Редактор McEdit:\
    ![print](src/imgs/Part_7_3.png)\
    Для выхода используется комбинация: `Esc`, выбор варианта Да, `Enter`.

- Редактирую файлы без сохранения изменений:
    - Vim:\
    ![editing](src/imgs/Part_7_4.png)\
    Для выхода используется комбинация: `Esc`, `:w!`, `Enter`.
    - Nano:\
    ![editing](src/imgs/Part_7_5.png)\
    Для выхода используется комбинация:  `Ctrl + X`, `N`, `Enter`.
    - McEdit:\
    ![editing](src/imgs/Part_7_6.png)\
    Для выхода используется комбинация: `Esc`, выбор варианта Нет, `Enter`.

- Редактирую файлы и использую поиск и замену слов:
    - Vim:\
    ![search](src/imgs/Part_7_7.png)\
    Поиск слова "school" без учета регистра. Используем комбинацию: `/school\c`.\
    ![replace](src/imgs/Part_7_8.png)\
    Замена слов "21" на "1221", `/g` - замена всех вхождений. Используем комбинацию: `:s/21/1221/g`.
    - Nano:\
    ![search](src/imgs/Part_7_9.png)\
    Поиск слова "21". Используем комбинацию: `Ctrl+W`, шаблон, `Enter`.\
    ![replace](src/imgs/Part_7_10.png)\
    Замена слов "21" на "1221". Используем комбинацию: `Ctrl+W`, `Ctrl+R`, шаблон, `Enter`.
    - McEdit:\
    ![search](src/imgs/Part_7_11.png)\
    Поиск слова "school" без учета регистра. Используем комбинацию: `F7`, шаблон, `Enter`.\
    ![replace](src/imgs/Part_7_12.png)\
    Замена слов "21" на "1221". Используем комбинацию: `F4`, шаблон, `Enter`, "Все", `Enter`.

## Part 8. Установка и базовая настройка сервиса **SSHD**

- Для установки службы SSHd устанавливаем пакет Openssh при помощи команды `sudo apt install openssh-server`.

- Активируем автостарт службы:\
![start](src/imgs/Part_8_1.png)

В большинстве разновидностей Linux конфигурационный файл SSH-сервера располагается по пути `/etc/ssh/sshd_config`.

- Редактирую этот файл добавляя строчку "Port 2022":\
![port](src/imgs/Part_8_2.png)\
После перезапускаем службу командой `/etc/init.d/ssh restart`.

- При помощи команды `ps -f | grep sshd` показываю наличие процесса:\
![ps](src/imgs/Part_8_3.png)\
Команда ps - выдача информации о состоянии процессов.\
`-f` - вывести максимум доступных данных.

- Вывод команды `netstat -tan`:\
![netstat](src/imgs/Part_8_4.png)\
Ключ `-n` – не пытаться преобразовать IP в имена хостов\
Ключ `-a` – вывести информацию обо всех портах/сокетах.\
Ключ `-t` – вывести информацию только по протоколу TCP.\
Proto Имя протокола (TCP или UDP).\
Recv-Q Количество байтов, которые не копируются пользовательскойпрограммой, подключенной к этому сокету.\
Send-Q Количество байтов, не подтвержденных удаленным хостом.
Local Address Адреса сети, которые предназначены только для коммуникаций в пределах одного сегмента местной сети или магистральной линии. Они позволяют обращаться к хостам, не используя общий префикс адреса.\
Foreign Address IP-адрес удалённого компьютере и порт сервер-приложения, с которым уже установлено соединение. Если не установлено, Вы увидите просто "*:*"\
State по нему вы можете узнать про TCP-соединение, установилось (ESTEBLISHED) оно или находится в состоянии прослушивания (LISTEN).
Локальная петля 0.0.0.0 – это локальный адрес, зарезервированный серверами.

## Part 9. Установка и использование утилит **top**, **htop**

- Вывод команды `top`: \
![top](src/imgs/Part_9_1.png)

- Исходя из него видно: 
    - uptime: 2 часа 19 минут. 
    - количество авторизованных пользователе: 2 users. 
    - общую загрузку системы: за одну - 0, пять - 0 и 15 минут назад - 0. 
    - общее количество процессов: 93 Total. 
    - загрузку cpu: 0.0 us - пользовательские процессы; 0.0 sy - процессы ядра. 
    - загрузку памяти: 151.7 used, 530.6 buff/cache. 
    - pid процесса занимающего больше всего памяти: 2564. 
    - pid процесса, занимающего больше всего процессорного времени: 2564.

- Вывод команды `htop`:
    - Отсортированный по PID: \
    ![htop](src/imgs/Part_9_2.png) 
    - Отсортированный по PERCENT_CPU: \
    ![htop](src/imgs/Part_9_3.png) 
    - Отсортированный по PERCENT_MEM: \
    ![htop](src/imgs/Part_9_4.png) 
    - Отсортированный по TIME: \
    ![htop](src/imgs/Part_9_5.png)

    - Отфильтрованный для процесса sshd: \
    ![htop](src/imgs/Part_9_6.png)
    
    - С найденным syslog: \
    ![htop](src/imgs/Part_9_7.png)

    - С добавлением вывода hostname, clock и uptime: \
    ![htop](src/imgs/Part_9_8.png)

## Part 10. Использование утилиты **fdisk**

- Вывод команды `fdisk -l`: \
![fdisk](src/imgs/Part_10_1.png)
- Исходя из этого становится ясно:
    - Название жесткого диска: /dev/sda или модель VBOX HARDDISK.
    - Размер: 10 GiB
    - Количество секторов: ~21 млн. 
    - Размер swap: Этого раздела нет.

## Part 11. Использование утилиты **df** 

- Вывод команды `df`: \
![df](src/imgs/Part_11_1.png)
- Исходя из этого становится ясно:
    - Размер раздела: 9219412.
    - Размер занятого пространства: 2581044.
    - Размер свободного пространства: 6150332.
    - Процент использования: 30%
- Единица измерения: Байт.

- Вывод команды `df -Th`: \
![df](src/imgs/Part_11_2.png)
- Исходя из этого становится ясно:
    - Размер раздела: 8,8G.
    - Размер занятого пространства: 2,5G.
    - Размер свободного пространства: 5,9G.
    - Процент использования: 30%
- Тип файловой системы для раздела: ext4.

## Part 12. Использование утилиты **du**

- Вывод команды `du`:
    - Без дополнений: \
    ![du](src/imgs/Part_12_1.png)
    - Для папок "/home": \
    ![du](src/imgs/Part_12_2.png)
    - Для папок "/var": \
    ![du](src/imgs/Part_12_3.png)
    - Для папок "/var/log": \
    ![du](src/imgs/Part_12_4.png)
    - Содержимое "/var/log": \
    ![du](src/imgs/Part_12_5.png)

## Part 13. Установка и использование утилиты **ncdu**

- Устанавливаем ncdu при помощи `sudo apt install ncdu`.
- Вывод размеров папок:
    - Папка "/home": \
    ![ncdu](src/imgs/Part_13_1.png)
    - Папка "/var": \
    ![ncdu](src/imgs/Part_13_2.png)
    - Папка "/var/log": \
    ![ncdu](src/imgs/Part_13_3.png)

## Part 14. Работа с системными журналами

- Последняя авторизация: Jan 11 09:22:21 shrek systemd-logind. \
![auth](src/imgs/Part_14_1.png)
- Перезапускаем sshd командой: `sudo service sshd restart`.
- Сообщение о рестарте sshd в файле /var/log/syslog: \
![sshd](src/imgs/Part_14_2.png)

## Part 15. Использование планировщика заданий **CRON**

- Для настройки используем команду: `crontab -e` \
![cron](src/imgs/Part_15_1.png)
- Вывод журнала выполнения команды: \
![log](src/imgs/Part_15_2.png)
- Наличие работы CRON в системнои журнале syslog:\
![syslog](src/imgs/Part_15_3.png)
- Для удаления заданий планировщика пишем: `crontab -r`